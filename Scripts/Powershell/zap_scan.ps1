#!/usr/bin/env ps1
# ===========================================================================================================================================================
#  /$$      /$$           /$$                /$$$$$$                                          /$$   /$$                       /$$                 /$$      
# | $$  /$ | $$          | $$               /$$__  $$                                        |__/  | $$                      | $$                | $$      
# | $$ /$$$| $$  /$$$$$$ | $$$$$$$         | $$  \__/  /$$$$$$   /$$$$$$$ /$$   /$$  /$$$$$$  /$$ /$$$$$$   /$$   /$$        | $$        /$$$$$$ | $$$$$$$ 
# | $$/$$ $$ $$ /$$__  $$| $$__  $$ /$$$$$$|  $$$$$$  /$$__  $$ /$$_____/| $$  | $$ /$$__  $$| $$|_  $$_/  | $$  | $$ /$$$$$$| $$       |____  $$| $$__  $$
# | $$$$_  $$$$| $$$$$$$$| $$  \ $$|______/ \____  $$| $$$$$$$$| $$      | $$  | $$| $$  \__/| $$  | $$    | $$  | $$|______/| $$        /$$$$$$$| $$  \ $$
# | $$$/ \  $$$| $$_____/| $$  | $$         /$$  \ $$| $$_____/| $$      | $$  | $$| $$      | $$  | $$ /$$| $$  | $$        | $$       /$$__  $$| $$  | $$
# | $$/   \  $$|  $$$$$$$| $$$$$$$/        |  $$$$$$/|  $$$$$$$|  $$$$$$$|  $$$$$$/| $$      | $$  |  $$$$/|  $$$$$$$        | $$$$$$$$|  $$$$$$$| $$$$$$$/
# |__/     \__/ \_______/|_______/          \______/  \_______/ \_______/ \______/ |__/      |__/   \___/   \____  $$        |________/ \_______/|_______/ 
#                                                                                                           /$$  | $$                                      
#                                                                                                          |  $$$$$$/                                      
#                                                                                                           \______/                                       
# ===========================================================================================================================================================
# ===========================================================================================================================================================
#  Script     : zap_scan.ps1
#  Auteur     : Lysius
#  Date       : 14/02/2024
#  Description: Script PowerShell pour zap scan.
# ===========================================================================================================================================================

param($target)
if(-not $target){Write-Host "Usage: zap_scan.ps1 -target <url>";exit}
$out="reports\zap_ps\" + (Get-Date -Format "yyyyMMdd_HHmmss")
New-Item -ItemType Directory -Path $out -Force
docker run --rm -v ${pwd}\tools\zap_config.json:/zap/config.json -v ${pwd}\$out:/zap/reports owasp/zap2docker-stable zap-baseline.py -t $target -r report.html
Move-Item report.html $out
