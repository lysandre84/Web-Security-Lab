#!/usr/bin/env ps1
# ===========================================================================================================================================================
#  /$$      /$$           /$$                /$$$$$$                                          /$$   /$$                       /$$                 /$$      
# | $$  /$ | $$          | $$               /$$__  $$                                        |__/  | $$                      | $$                | $$      
# | $$ /$$$| $$  /$$$$$$ | $$$$$$$         | $$  \__/  /$$$$$$   /$$$$$$$ /$$   /$$  /$$$$$$  /$$ /$$$$$$   /$$   /$$        | $$        /$$$$$$ | $$$$$$$ 
# | $$/$$ $$ $$ /$$__  $$| $$__  $$ /$$$$$$|  $$$$$$  /$$__  $$ /$$_____/| $$  | $$ /$$__  $$| $$|_  $$_/  | $$  | $$ /$$$$$$| $$       |____  $$| $$__  $$
# | $$$$_  $$$$| $$$$$$$$| $$  \ $$|______/ \____  $$| $$$$$$$$| $$      | $$  | $$| $$  \__/| $$  | $$    | $$  | $$|______/| $$        /$$$$$$$| $$  \ $$
# | $$$/ \  $$$| $$_____/| $$  | $$         /$$  \ $$| $$_____/| $$      | $$  | $$| $$      | $$  | $$ /$$| $$  | $$        | $$       /$$__  $$| $$  | $$
# | $$/   \  $$|  $$$$$$$| $$$$$$$/        |  $$$$$$/|  $$$$$$$|  $$$$$$$|  $$$$$$/| $$      | $$  |  $$$$/|  $$$$$$$        | $$$$$$$$|  $$$$$$$| $$$$$$$/
# |__/     \__/ \_______/|_______/          \______/  \_______/ \_______/ \______/ |__/      |__/   \___/   \____  $$        |________/ \_______/|_______/ 
#                                                                                                           /$$  | $$                                      
#                                                                                                          |  $$$$$$/                                      
#                                                                                                           \______/                                       
# ===========================================================================================================================================================
# ===========================================================================================================================================================
#  Script     : header_tester.ps1
#  Auteur     : Lysius
#  Date       : 15/09/2023
#  Description: Script PowerShell pour header tester.
# ===========================================================================================================================================================

# header_tester.ps1 — vérifie les en-têtes de sécurité HTTP
param(
    [string]$Url = "http://localhost"
)
$response = Invoke-WebRequest -Uri $Url -UseBasicParsing
$headers = @('X-Frame-Options','Content-Security-Policy','X-XSS-Protection')
foreach ($h in $headers) {
    if ($response.Headers[$h]) {
        Write-Output "[+] $h présent: $($response.Headers[$h])"
    } else {
        Write-Output "[-] $h absent"
    }
}